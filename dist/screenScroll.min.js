!function(e){var t={header:!1,footer:!1,startScreen:0,scrollTimeOut:800,headerFixed:!1,footerFixed:!1,responsive:null};e.fn.screenScroll=function(n){var r,o,i=e.extend({},t,n),s=e(this),c=e(this).children("section"),h=(n={windowHeight:0,windowWidth:0,headerHeight:0,footerHeight:0,screenCount:0,headerFixed:void 0!=i.headerFixed?i.headerFixed:t.headerFixed,footerFixed:void 0!=i.footerFixed?i.footerFixed:t.footerFixed,responsiveKey:null,responsiveStructure:null,getValues:function(){return this.windowHeight=e(window).height(),this.windowWidth=e(window).width(),this.headerHeight=i.header?i.header.outerHeight():0,this.footerHeight=i.footer?i.footer.outerHeight():0,this},getResponsiveKey:function(){if(this.getValues(),null!=i.responsive){var t=this.windowWidth,n=null;e.each(i.responsive,function(e,r){t>e&&(n=e)}),this.responsiveKey=n}return this.responsiveKey},getResponsiveOptions:function(){var e;return null!=this.getResponsiveKey()?((e=i.responsive[this.responsiveKey]).headerFixed=void 0!=e.headerFixed?e.headerFixed:this.headerFixed,e.footerFixed=void 0!=e.footerFixed?e.footerFixed:this.footerFixed,e):((e={}).headerFixed=this.headerFixed,e.footerFixed=this.footerFixed,e)},createResponsiveStructure:function(){if(null!=i.responsive){var t={},n=c.length;return e.each(i.responsive,function(r,o){if(void 0!=o.screens){var i=[],s=0;e.each(o.screens,function(e,t){var n=t.sections.sort();s+=n.length}),s=o.screens.length+(n-s);for(var c=0,h=0;h<s;h++){var a=!1;e.each(o.screens,function(e,t){var n=t.sections.sort();-1!=n.indexOf(c)&&(a=!0,void 0==i[h]&&(i[h]=n.length,c+=n.length))}),a||(i[h]=1,c+=1),0!=h&&(i[h]+=i[h-1])}t[r]=i}}),this.responsiveStructure=t}},convertCurrentIndex:function(t,n,r){defaultStructure=[];for(var o=0;o<c.length;o++)defaultStructure.push(o+1);var i=this.responsiveStructure[n]?this.responsiveStructure[n]:defaultStructure,s=this.responsiveStructure[r]?this.responsiveStructure[r]:defaultStructure,h=0,a=0!=t?i[t-1]+1:i[t-1];return e.each(s,function(e,t){if(t>=a)return h=e,!1}),h},getScreenFromSectionIndex:function(t){if(null!=this.responsiveStructure[this.responsiveKey]){var n=this.responsiveStructure[this.responsiveKey],r=0;return e.each(n,function(e,n){if(t<=n)return r=e,!1}),r}return t-1}},{canMove:!0,count:0,currentScreenIndex:i.startScreen?i.startScreen:0,responsiveKey:null,screenHeight:n.windowHeight,screenHeightFirst:n.windowHeight,screenHeightLast:n.windowHeight,init:function(){this.createScreens(),n.createResponsiveStructure(),0!=this.currentScreenIndex&&this.to(this.currentScreenIndex)},getScreenOptions:function(){var e=n.getResponsiveOptions();return null!=e&&void 0!=e.screens?e.screens:null},getAll:function(){return s.children("section.screen")},createScreens:function(){this.responsiveKey=n.getResponsiveKey();var t=this.getScreenOptions();t?(e.each(t,function(t,n){if(void 0!=n.sections){var r=e();e.each(n.sections,function(t,n){r=e(r).add(c.eq(n))}),r.wrapAll('<section class="screen"></section>')}}),s.children("section").not(".screen").wrap('<section class="screen"></section>')):s.children("section").wrap('<section class="screen"></section>'),this.setScreenHeight(n.windowHeight),this.mouseEvents(this.getAll()),this.count=this.getAll().length},setScreenHeight:function(t){var r=t,o=n.getResponsiveOptions();o.headerFixed&&(i.header&&e(i.header).addClass("fixedHeader"),r-=n.headerHeight,this.getAll().css("padding-top",n.headerHeight)),o.footerFixed&&(i.footer&&e(i.footer).addClass("fixedFooter"),r-=n.footerHeight,this.getAll().css("padding-bottom",n.footerHeight)),this.getAll().height(r),this.screenHeight=this.screenHeightFirst=this.screenHeightLast=r,o.headerFixed||(i.header&&e(i.header).removeClass("fixedHeader"),this.screenHeightFirst=this.screenHeightFirst-n.headerHeight,this.getAll().first().height(this.screenHeightFirst)),o.footerFixed||(i.footer&&e(i.footer).removeClass("fixedFooter"),this.screenHeightLast=this.screenHeightLast-n.footerHeight,this.getAll().last().height(this.screenHeightLast)),this.setSectionHeight()},setSectionHeight:function(){var t=this.getScreenOptions(),n=this;e.each(t,function(t,r){if(void 0!=r.sections){function o(e,t){return e-t}e.each(r.sections,function(e,t){void 0!=r.size&&100!=r.size&&(0==r.sections.sort(o)[0]?c.eq(t).height(n.screenHeightFirst/(100/r.size)):r.sections.sort(o)[r.sections.length-1]==c.length-1?c.eq(t).height(n.screenHeightLast/(100/r.size)):c.eq(t).height(n.screenHeight/(100/r.size)))})}})},mouseEvents:function(t){t.on("touchmove",function(e){e.preventDefault()});var n,r,o=this;t.bind("touchstart",function(e){n=e.originalEvent.touches[0].clientY,r=e.originalEvent.touches[0].clientX}),t.bind("touchend",function(t){var i=t.originalEvent.changedTouches[0].clientY,s=t.originalEvent.changedTouches[0].clientX;Math.abs(i-n)>Math.abs(s-r)&&(n>i+5?e(this).is(":last-child")||o.moveToNext():n<i-5&&(e(this).is(":first-child")||o.moveToPrev()))}),t.on("mousewheel",function(t){t.preventDefault(),t.originalEvent.deltaY>0?e(this).is(":last-child")||o.moveToNext():e(this).is(":first-child")||o.moveToPrev()})},moveToNext:function(){return!!this.moveTo(this.currentScreenIndex+1)},moveToPrev:function(){return!!this.moveTo(this.currentScreenIndex-1)},to:function(t){if(t<0||t>=this.count)return!1;var r=-1*t*n.windowHeight,o=e(".screen-transition");o.removeClass("screen-transition"),o.css("transform","translate3d(0, "+r+"px, 0)"),o.css("-webkit-transform","translate3d(0, "+r+"px, 0)"),o.css("-o-transform","translate3d(0, "+r+"px, 0)"),o.css("transform","translate3d(0, "+r+"px, 0)"),this.currentScreenIndex=t,setTimeout(function(){o.addClass("screen-transition")},50)},moveTo:function(e){if(e<0||e>=this.count)return!1;if(this.canMove){s.trigger("screenScroll.beforeMove",{currentScreenIndex:h.currentScreenIndex,currentScreen:this.getAll().eq(h.currentScreenIndex),responsiveOptions:n.getResponsiveOptions()});var t=-1*e*n.windowHeight;this.move(t),this.canMove=!1,this.currentScreenIndex=e;var r=this;return setTimeout(function(){r.canMove=!0},i.scrollTimeOut),s.trigger("screenScroll.afterMove",{currentScreenIndex:e,currentScreen:this.getAll().eq(e),responsiveOptions:n.getResponsiveOptions()}),!0}return!1},moveToSection:function(e){var t=n.getScreenFromSectionIndex(e);return"number"==typeof t&&this.moveTo(t)},goToSection:function(e){var t=n.getScreenFromSectionIndex(e);return"number"==typeof t&&this.to(t)},goToSectionId:function(e){var t=c.filter("#"+e);if(t.length>0){var r=n.getScreenFromSectionIndex(c.index(t));return"number"==typeof r&&this.to(r)}return!1},moveToSectionId:function(e){var t=c.filter("#"+e);if(t.length>0){var r=n.getScreenFromSectionIndex(c.index(t)+1);return"number"==typeof r&&this.moveTo(r)}return!1},move:function(t){e(".screen-transition").animate({textIndent:0},{step:function(n){e(this).css("-moz-transform","translate3d(0, "+t+"px, 0)"),e(this).css("-webkit-transform","translate3d(0, "+t+"px, 0)"),e(this).css("-o-transform","translate3d(0, "+t+"px, 0)"),e(this).css("transform","translate3d(0, "+t+"px, 0)")},duration:0})},destroy:function(){s.children("section.screen").children().unwrap().height(""),this.count=0},refresh:function(){var e=n.getResponsiveKey();if(this.responsiveKey!=e){var t=n.convertCurrentIndex(this.currentScreenIndex,this.responsiveKey,e);this.destroy(),this.createScreens(),this.to(t),this.currentScreenIndex=t}else n.getValues(),this.setScreenHeight(n.windowHeight),this.to(this.currentScreenIndex)}});function a(){e("html").addClass("screen-scroll");var t=n.getResponsiveOptions();if(r!=t.headerFixed||o!=t.footerFixed){var c=s;e("#screen-scroll").children().unwrap(),c=i.header&&!t.headerFixed?c.add(i.header):c,(c=i.footer&&!t.footerFixed?c.add(i.footer):c).wrapAll('<div id="screen-scroll" class="screen-transition"></div>'),r=t.headerFixed,o=t.footerFixed}}return a(),h.init(),e(window).resize(function(e){a(),h.refresh(),s.trigger("screenScroll.resize",{options:n,screens:h})}),e('*[data-screenscroll="next"]').on("click",function(){return h.canMove=!0,h.moveToNext(),s}),e('*[data-screenscroll="prev"]').on("click",function(){return h.canMove=!0,h.moveToPrev(),s}),e("*[data-screenscroll-movetosection]").on("click",function(){var t=e(this).data("screenscroll-movetosection");return""!=t&&(h.canMove=!0,"string"==typeof t&&h.moveToSectionId(t),"number"==typeof t&&h.moveToSection(t),!1)}),e("*[data-screenscroll-gotosection]").on("click",function(){var t=e(this).data("screenscroll-gotosection");return""!=t&&(h.canMove=!0,"string"==typeof t&&h.goToSectionId(t),"number"==typeof t&&h.goToSection(t),!1)}),e("*[data-screenscroll-moveto]").on("click",function(){var t=e(this).data("screenscroll-moveto");return h.canMove=!0,"number"==typeof t&&h.moveTo(t),!1}),e("*[data-screenscroll-goto]").on("click",function(){var t=e(this).data("screenscroll-goto");return h.canMove=!0,"number"==typeof t&&h.to(t),!1}),e(window).on("screenScroll.next",function(){return h.canMove=!0,h.moveToNext(),s}),e(window).on("screenScroll.prev",function(){return h.canMove=!0,h.moveToPrev(),s}),e(window).on("screenScroll.moveTo",function(e,t){return h.canMove=!0,h.moveTo(t),s}),e(window).on("screenScroll.goTo",function(e,t){return h.canMove=!0,h.to(t),s}),e(window).on("screenScroll.moveToSection",function(e,t){return h.canMove=!0,h.moveToSection(t),s}),e(window).on("screenScroll.goToSection",function(e,t){return h.canMove=!0,h.goToSection(t),s}),e(window).on("screenScroll.goToSectionId",function(e,t){return h.canMove=!0,h.goToSectionId(t),s}),e(window).on("screenScroll.moveToSectionId",function(e,t){return h.canMove=!0,h.moveToSectionId(t),s}),s.trigger("screenScroll.init",{options:n,screens:h}),s}}(jQuery);